<html>
<head>
<title>English and Characters</title>
<link rel = "stylesheet" type = "text/css" href = "../CSS/Memory Games.css"></link>

<h1>English and Characters Memory Game</h1>

<input class="MemoryBack" onClick="window.location.href = '6) Memory Game Menu.html'" type="button" value="Back"/>

<script>

// Characters need to be stored in their unicode representation. 
var ni = '\u4F60';
var nin = '\u60A8';
var hao = '\u597D';
var wo = '\u6211';
var hen = '\u5F88';
var ma = '\u5417'; 

// An array that will contain the tile values that are selected by the user.
var charList = [ni, nin, hao, wo, hen, ma];
var wordList = ['You', 'You (Polite)', 'Good', 'I, me', 'Very', 'Interrogative word'];
var gameTiles = charList.concat(wordList);
var tilesSelected = []; 

// An array that will contain memory tile IDs that the user selects.
var memory_tile_ids = [];  

// This variable will contain the total number of tiles that are matched. This will be compared with the total number of tiles at the end of each match.
var tilesFlipped = 0;

// This code is the shuffle method used to randomise the values in ‘gameTiles’. The code was found through research on the internet.
Array.prototype.shuffle_tiles = function() {
    var i = this.length, j, temp;
    while (--i > 0) {
        j = Math.floor(Math.random() * (i + 1));
        temp = this[j];
        this[j] = this[i];
        this[i] = temp;
    }
}

// Generates a new board.
function newBoard() {
	tilesFlipped = 0;
	var tiles_generated = '';
    gameTiles.shuffle_tiles(); 
	
	// 'gameTiles' is searched and a tile is added in the variable 'tiles_generated' for every value in 'gameTiles'.
	for (var i = 0; i < gameTiles.length; i++) {
		// When a tile is clicked on, run the flipTile method.
		tiles_generated += '<div id="tile_' + i +'" onclick="flipTile(this,\'' + gameTiles[i] + '\')"></div>';
	}   
	
	// At the end of the 'FOR' loop, the contents of 'tiles_generated' (the tiles) is equated to the memory board   
	document.getElementById('memory_board').innerHTML = tiles_generated;
}

// Performs the actions involved when flipping a single tile.
function flipTile(tile, value) {
	// The code will run if a tile is not currently selected, but clicked on and there are less than two tiles selected.
	if (tile.innerHTML == "" && tilesSelected.length < 2) {
		
		// The background of the tile will be white when selected.
		tile.style.background = 'White';
		
		// When the tile is flipped, the tile will display the value.
		tile.innerHTML = value;
		
		// The code will run if a tile is selected, but there is nothing in the 'tilesSelected' arrays.
		if (tilesSelected.length == 0) {  
			// The tile value's index will be added to the 'tilesSelected' array and the tile ID will be added to the 'memory_tile_ids' array.
			var indexSelected = getItemPosition(value);
			tilesSelected.push(indexSelected);
			memory_tile_ids.push(tile.id);
		
		// The code will run if there is already a value in 'tilesSelected' array meaning that there will be two values after the next part of the code has run.
		} else if (tilesSelected.length == 1) {
			// Adds the tile value's index and ID into their respective arrays.
			var indexSelected = getItemPosition(value);
			tilesSelected.push(indexSelected);
			memory_tile_ids.push(tile.id);
			
			// Check if the tile values' indexes match (from their respective arrays).
			if (tilesSelected[0] == tilesSelected[1]) {
				 
				// If there is a match with the two tiles, then two will be added to the total number of tiles selected.
				tilesFlipped += 2;
				
				// Both arrays are cleared. 
				tilesSelected = [];
            	memory_tile_ids = [];
				 
				// Generate a new board once all the tiles have been flipped.
				if (tilesFlipped == gameTiles.length) {
					alert("Board cleared... generating new board");
					document.getElementById('memory_board').innerHTML = "";               
					newBoard();
				}
				
			// Flip the tiles back if they don't match.
			} else {
				// The time it takes for the cards to flip back over.
				setTimeout(flip_tiles_Back, 700);
			}
		}
	}
}

// Flip the 2 tiles back over
function flip_tiles_Back() {
					
	// The first tile ID in the array is stored in a variable.
	var tile_1 = document.getElementById(memory_tile_ids[0]);
					
	// The second tile ID in the array is stored in a variable.
	var tile_2 = document.getElementById(memory_tile_ids[1]);  
					
	// Both variables are cleared in order for both tiles to be flipped back over. 
    tile_1.innerHTML = "";
    tile_2.innerHTML = "";
					
	// Both arrays are cleared.
	tilesSelected = [];
    memory_tile_ids = [];
}

// Gets the tile value's index in its respective array.
function getItemPosition(tileValue) {
	var index = charList.indexOf(tileValue);
	if (index < 0) {
		index = wordList.indexOf(tileValue);
	}
	return index;
}
</script>
</head>
<body>
<!-- Just like the boxes in the sentence pages. The ‘div’ tags will act as a section of the HTML page and CSS will be used to create the memory board. -->
<div id="memory_board"></div>

<!-- The function ‘newBoard’ is called here. This will mean that the function will run when the page opens on 
     the web browser otherwise the code in the functions will not run at all. -->
<script>newBoard();</script>
</body>
</html>